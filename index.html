<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catastrophes et Météo Mondiales</title>
<link rel="icon" href="favicon.ico" type="image/x-icon">
<style>
    body { 
        font-family: Arial, sans-serif; 
        margin: 0; 
        padding: 0; 
        background: black;
        color: white;
    }
    h1 { 
        text-align: center; 
        padding: 20px; 
        background: rgba(0, 0, 0, 0.7); 
        margin: 0; 
    }
    .container { 
        max-width: 900px; 
        margin: 20px auto; 
        background: rgba(0, 0, 0, 0.8); 
        padding: 20px; 
        border-radius: 10px; 
        box-shadow: 0px 0px 15px rgba(255, 255, 255, 0.3);
    }
    .event { 
        padding: 15px; 
        border-bottom: 1px solid #444; 
        margin-bottom: 10px;
        border-radius: 5px;
        background: rgba(255,255,255,0.05);
    }
    .event:last-child { border-bottom: none; }
    .weather { margin-top: 10px; font-size: 0.9em; color: #ccc; }

    #loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        background: black;
    }
    .loader {
        border: 8px solid rgba(255, 255, 255, 0.3);
        border-top: 8px solid #fff;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 2s linear infinite;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    #eventsContainer { display: none; }
</style>
</head>
<body>

<div id="loading-screen"><div class="loader"></div></div>

<h1>Derniers Événements Mondiaux & Météo</h1>
<div class="container" id="eventsContainer"></div>

<script>
const OPENWEATHER_API_KEY = 'VOTRE_CLE_OPENWEATHER'; // Remplace par ta clé OpenWeatherMap

async function fetchWeather(lat, lon) {
    try {
        let response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${OPENWEATHER_API_KEY}&lang=fr&units=metric`);
        let data = await response.json();
        return `Météo: ${data.weather[0].description}, Température: ${data.main.temp}°C, Humidité: ${data.main.humidity}%`;
    } catch {
        return 'Météo non disponible';
    }
}

async function fetchEvents() {
    try {
        let response = await fetch('https://eonet.gsfc.nasa.gov/api/v3/events');
        let data = await response.json();
        let container = document.getElementById('eventsContainer');
        let loadingScreen = document.getElementById('loading-screen');

        loadingScreen.style.display = 'none';
        container.style.display = 'block';
        container.innerHTML = '';

        for (let event of data.events) {
            let eventTime = new Date(event.geometry[0]?.date || event.geometry[0]?.time || Date.now());
            let minutesAgo = Math.floor((Date.now() - eventTime) / 60000);

            let lat = event.geometry[0]?.coordinates[1] || 0;
            let lon = event.geometry[0]?.coordinates[0] || 0;
            let weatherInfo = await fetchWeather(lat, lon);

            let div = document.createElement('div');
            div.className = 'event';
            div.innerHTML = `
                <strong>${event.title}</strong><br>
                Catégorie: ${event.categories.map(c => c.title).join(', ')}<br>
                Localisation: ${lat.toFixed(2)}, ${lon.toFixed(2)}<br>
                Date: ${eventTime.toLocaleString('fr-FR')}<br>
                Il y a ${minutesAgo} minutes<br>
                <span class="weather">${weatherInfo}</span>
            `;
            container.appendChild(div);
        }
    } catch (error) {
        let container = document.getElementById('eventsContainer');
        container.innerHTML = 'Erreur de chargement des données';
        document.getElementById('loading-screen').style.display = 'none';
        console.error(error);
    }
}

fetchEvents();
setInterval(fetchEvents, 60000);
</script>

</body>
</html>
